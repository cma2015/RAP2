<tool id="pathway_activity_analysis" name="Pathway activity analysis" version="17.09">
  <description>
  </description>
  <requirements>
      <requirement type="package" version="3.4.2">R</requirement>
      <requirement type="package" version="1.2.0">getopt</requirement>
  </requirements>

  <command>	
	Rscript /galaxy/tools/TAMF/pathway_activity_analysis.R

	--input1
		$geneexpression
	--input2
        $amplitude
    --input3
        $pattern
    --input4
        $pathway
    --input5
        $cpu

    --output1 
        $active
    --pdf1
        $network    
;

</command>

  <inputs>	
    <param name="geneexpression" type="data" label="prepared gene expression matrix" />
    <param name="amplitude" type="data" label="amplitude matrix" />
    <param name="pattern" type="data" label="pattern matrix" />
    <param name="pathway" type="data" label="pathway annotation" />
    <param name="cpu" type="text" value="2" label="cpu number" />

  </inputs>  
	 <stdio><exit_code range="1:" level="fatal" description="Error"/></stdio> 
  <outputs>
    <data name="active" format="tabular" label="actived pathways" help="differentially expressed pathways" />
    <data name="network" format="pdf" label="interactive network" help="actived pathways interactive network" />
  </outputs>


    <help>
.. class:: infomark

**What it does**

*Pathway activity analysis* is used to find the actived pathways and their interactive network


-------------

.. class:: infomark

**Inputs**

**prepared gene expression matrix** - the prepared gene expression matrix through the **Matrix preparation** tool

* **amplitude matrix** - generated from the prepared gene expression matrix through **Matrix factorization** tool in the **History** panel


* .. csv-table:: 
   :header: " ", "NC1", "NC2", "NC3"
   :widths: 15, 10, 10, 10

   "AT1G01010", 1.430, 0.916, 0.360
   "AT1G01030", 0.498, 0.648, 0.611
   "AT1G01040", 1.309, 1.059, 0.890
   "AT1G01050", 1.773, 1.512, 1.122

|


* **pattern matrix** - generated from the prepared gene expression matrix through **Matrix factorization** tool in the **History** panel

* .. csv-table:: 
   :header: " ", "NC1", "NC2", "NC3"
   :widths: 15, 10, 10, 10

   "Sample1", 0.840, 2.573, 5.048
   "Sample2", 0.741, 2.666, 5.029
   "Sample3", 0.900, 2.543, 4.914
   "Sample4", 0.843, 2.653, 4.869

|


* **pathway** - the pathway annotation file


*    +-------------+----------------------------------------------------------------------------+-----------+------------+
     | Pathway_id  | Pathway_name                                                               | Gene_id   | Gene_name  |
     +=============+============================================================================+===========+============+
     | PWY-5272    | abscisic acid degradation by glucosylation                                 | AT1G52400 | BG1        |
     +-------------+----------------------------------------------------------------------------+-----------+------------+
     | PWY-5272    | abscisic acid degradation by glucosylation                                 | AT4G15550 | AT4G15550  |
     +-------------+----------------------------------------------------------------------------+-----------+------------+
     | PWY-5910    | superpathway of geranylgeranyldiphosphate biosynthesis I (via mevalonate)  | GQT-5178  | AT1G36623  |
     +-------------+----------------------------------------------------------------------------+-----------+------------+
     | PWY-7213    | wogonin metabolism                                                         | unknown   | unknown    |
     +-------------+----------------------------------------------------------------------------+-----------+------------+

|

* **cpu number** - the cpu number to parallelly compute

-------------


.. class:: infomark

**Outputs**

**actived pathways** - the differentially expressed pathways

+-------------+------------------------------------------------+
| Pathway_id  | Pathway_name                                   |
+=============+================================================+
| PWY-101     | photosynthesis light reactions                 |
+-------------+------------------------------------------------+
| PWY-782     | glycolipid desaturation                        |
+-------------+------------------------------------------------+
| PWY66-399   | gluconeogenesis III                            |
+-------------+------------------------------------------------+
| SUCSYN-PWY  | sucrose biosynthesis I (from photosynthesis)   |
+-------------+------------------------------------------------+

|


**interactive network** - the interactive network among the actived pathways

.. image:: static/interactive_network.jpg
    :width: 500 px
    :scale: 70 %   
    :align: center

| 


-------------

.. class:: warningmark

**Note**

* The user should upload the pathway annotation file to keep the format with the example data


-------------

|


  </help>




</tool>
