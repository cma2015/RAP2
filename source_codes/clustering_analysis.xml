<tool id="clustering_analysis" name="Clustering analysis">
<description>
  </description>
  <requirements>
      <requirement type="package" version="3.4.2">R</requirement>
      <requirement type="package" version="1.2.0">getopt</requirement>
  </requirements>

  <command>	
	Rscript /galaxy/tools/TAMF/clustering_analysis.R 

	--input1
		$pattern
	--input2
        $model   
    --pdf1 
        $cluster
    --output1
        $information
;
</command>

  <inputs>	    
    <param name="pattern" type="data" label="pattern matrix" />
    <param name="model" type="select" label="cluster model" multiple="true" display="checkboxes" help="cluster model" >
                <option value="1" selected="true">mclust</option>
                <option value="2">apcluster</option>
                <option value="3">SSE</option>
                <option value="4">fpc</option>
                <option value="5">vegan</option>
                <option value="6">gap</option>               
    </param>

  </inputs>  
	 <stdio><exit_code range="1:" level="fatal" description="Error"/></stdio> 
  <outputs>
    <data name="cluster" format="pdf" label="cluster visulization" help="dot plot of the cluster" />
    <data name="information" format="tabular" label="cluster information" help="the cluster of the samples in each selected method" />
  </outputs>


    <help>
.. class:: infomark

**What it does**

*Clustering analysis* is used to automatically cluster the samples and return the cluster information

-------------

.. class:: infomark

**Inputs**

**pattern matrix** - generated from the prepared gene expression matrix through **Matrix factorization** tool in the **History** panel:

.. csv-table:: 
   :header: " ", "NC1", "NC2", "NC3", "NC4"
   :widths: 15, 10, 10, 10, 10

   "Sample1", -62.760, 48.076, -105.296, 49.677
   "Sample2", -68.101, 43.129, -112.948, 47.088
   "Sample3", -58.931, 37.168, -112.116, 55.410
   "Sample4", -63.240, 35.962, -108.744, 50.796

|


**cluster model** - the automatically cluster model. Currently, we provide six options: **mclust**, **apcluster**, **SSE**, **fpc**, **vegan**, **gap**

-------------


.. class:: infomark

**Outputs**

**cluster visulization** - the dot plot of the clustering result

.. image:: static/cluster.jpg
    :width: 500 px
    :scale: 100 %   
    :align: center

| 


**cluster information** - the cluster of the samples in each selected method

.. csv-table:: 
   :header: " ", "mclust", "apcluster"
   :widths: 15, 10, 10

   "Sample1", 1, 18
   "Sample7", 7, 18
   "Sample11", 3, 21
   "Sample15", 7, 14

-------------

|

  </help>





</tool>
